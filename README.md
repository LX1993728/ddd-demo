# 目录说明
## ① `application` 应用服务层包 : 组合领域服务、RPC、事件的发布订阅类、防腐设计
- `acl` ：防腐层，在进行**RPC调用**以及**服务迁移过渡**时防止污染领域对象。
  - `adapter`：在涉及到新旧服务并存以及流量切换时会在该包下定义适配器，配合流量开关进行服务切换。
  - `facade`：定义RPC调用类，进行RPC调用后将需要的关键数据组装转换为DO对象。
  - `mappers` : 将调用结果DTO映射为DO对象。
- `event` ：用于**具体领域事件的发布订阅逻辑**。
  - `publish` ：对应各种事件的发布处理逻辑，一般会应用服务中使用发布类。
  - `subscribe` ：对应各种事件的订阅逻辑，一般会在订阅类中使用应用服务。
- `provider` ：用于公开**RPC服务**，提供DTO对象，一般会组合使用应用服务。
  - `dto`：用来返回封装的结果数据。
  - `mappers`：用来将领域对象DO映射转换为DTO结果对象。
- `service` ： **应用服务**，用于**组合调用领域服务**， 提供领域DO对象，一个应用服务类就对应一个操作或者是一整块完整的业务逻辑， 在服务内会涉及认证、授权、领域服务编排、发起RPC调用。

## ② `controllers` 接口层包，向客户端提供服务调用接口，仅做参数和结果的转换，不做具体的逻辑。
- `dto`: 响应内容类，一般作为`Response<T>`类的内容。一般需要映射聚合多个DO对象。
- `vo` : 请求参数类，一般作为`Request<T>` 类的内容。(可视具体情况来决定是否映射DO)。
- `mappers` ：定义映射转换接口。`DO-->DTO` 及 `VO-->DO`。 
- `facade` ：定义控制器，用于组合调用应用服务完成业务，并返回要求数据格式的DTO。

## ③ `domains` ：领域包，内部存在多个聚合包。
- `aggregateXXX`
  - `entity`：领域实体包，定义领域对象（领域模型中的实体，值对象、实体、聚合根）。
    - `实体`：定义领域实体自身相关的**业务方法**（不包含数据库相关业务）。
    - `值对象`：将涉及到外部模块相关的冗余信息，使用JSON嵌入的方式保存到实体对应的字段中。
    - `聚合根`：包含当前聚合相关的所有结构信息，也是仓储、领域层以及与应用层交互的参数。
  - `event`：定义领域事件类。
  - `repository`：仓储类，对整个聚合进行查询、持久化。
    - `po`：定义与表一一对应的持久PO对象，`只包含基本数据类型`。
    - `facade`：定义仓储接口，一般只有一个。（仓储中的参数和返回值一般都固定为**聚合根领域对象**，具体操作有定义的方法名体现）。
    - `persistence`：仓储接口的实现，会组合调用`dao`并通过映射转为DO返回值。
      - `mappers`：定义映射转换接口，`PO<-->DO`
    - `dao`: 这里仅定义单表的增删改查操作。
  - `service`：领域服务，仅封装当前聚合相关（或跨实体）的业务逻辑方法，一般会组合调用仓储接口和实体的充血方法，涉及持久时开启事务。

## ④ `infrastructure` 基础层（包含全局的、通用的、抽象的、不变的类或工具）
- `config`：定义配置相关的信息
- `core`：定义领域事件的抽象基类或发布订阅工具类。
- `util`：定义需要的工具包。

## 大致的设计原则
- 聚合不宜太大，聚合太大会使逻辑复杂且聚合根太大，导致调用过程中存在过多冗余数据。
- 接口层服务及仓储和领域层服务参数值和返回值尽量固定为聚合根对象，聚合内业务变动时不需要修改接口参数。
- 做好各层数据结构间的映射，例如领域模型DO可以完全和业务类保持一致需要修改时，修改相关映射即可，保证独立性。
- 严格保证职责单一（固定调用规则及划清业务职责），在涉及后期服务演化时，以方便将对应聚合包和基础层移植出去。
- 做好防腐设计，即与外部交互时做DTO与DO间的映射。